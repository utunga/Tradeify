<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Tradeify"
      height="600" scrolling="true">
    <Require feature="dynamic-height"/>
    <Require feature="opensocial-0.7" />
  </ModulePrefs>
  <!-- Content section for profile view omitted -->
  <Content type="html" view="canvas">
    <![CDATA[
 
<link href="http://tradeify.org/osocial/tradeify_widget.css" rel="stylesheet" type="text/css" media="all" />
<link href="http://tradeify.org/css/ooooby_theme/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css" media="all" />


<input type="text" class="ui-state-default ui-corner-all" name="searchdata"/>
<button class="ui-button ui-state-default ui-corner-all" onclick="queryServer()">search</button>
<button class="ui-button ui-state-default ui-corner-all open_post" rel="#post_your_own_form">Post Your Own</button>

<div id="post_your_own_form" class="ui-widget">

	<div class="tooltip"></div> 
    
    <div class="rawMessage">	
      <fieldset>
        <legend>Your message</legend>	
       <textarea title="" cols="42" rows="6" name="message" class="ui-state-default ui-corner-all ui-state-disabled" id="message"></textarea>
       </fieldset>
    </div>
     
    <fieldset id="by_parts" class="ui-corner-all">
        <legend>Or... use this form</legend>
        <div class="offerPart">
            <label for="offer">I am offering ... </label>
            <textarea tabindex="0" cols="42" rows="3" type="text" name="offer" class="ui-state-default ui-corner-all" id="offer" ></textarea>
        </div>
        
       <div class="currency">
            <label for="for" class="desc"> for </label>
            <div class="fg-buttonset fg-buttonset-multi">

                <a href="#" class="fg-button fg-button-icon-left ui-state-default ui-corner-tag">
                    <span class="ui-icon ui-icon-tag"></span>barter</a>
                <a href="#" class="fg-button fg-button-icon-left ui-state-default ui-corner-tag">
                    <span class="ui-icon ui-icon-tag"></span>free</a>
            </div>

        </div>
        
        <div class="location">
            <label for="location"> in </label>
            <input type="text" class="ui-state-default ui-corner-all" tabindex="1" name="location" id="location"/>
            <div id="map_canvas" ></div> <!--map goes here -->
            <div class="infobox"></div>
              <!--  <div class="example"> e.g. &quot;in L:Wellington, NZ&quot; (click to change)</div>-->
        </div>
        
      
        <div class="until">  
            <label for="until" class="desc"> until </label>
            <input type="text" name="until" id="until" class="ui-state-default ui-corner-all" />
        </div>
                    
        <div class="tags">
            <label> Tags </label>
            <ul id="selected_tags">
                <li><a href="#" class="tag"></a></li>
            </ul>
            <blockquote>
                <h4>Suggested Tags (click to select)</h4> 
                <div id="suggested_tags">
                    <span class="template">
                        <ul class="select_tag_container">
                            <li><a href="#" class="tag"></a></li>
                        </ul>
                    </span>
                </div>
                <h4>Or type to add more</h4> 
                <input id="tags" name="tags" onkeyup="timeoutKeyChange()" class="ui-state-default ui-corner-all" tabindex="8" maxlength="255" />
            </blockquote>
        
        </div>
        
        <div class="thumbnail">
            <label for="picture_thumbnail"> Link to picture? </label>
            <input type="text" tabindex="8" maxlength="255" class="ui-state-default ui-corner-all" name="picture" id="picture" >
        </div>
        
        <div>
            <button name="cancel" class="close ui-priority-secondary ui-corner-all" value="cancel" >cancel</button>
            <button name="submit" class="ui-priority-primary ui-corner-all" value="done" >done</button>	
        </div>
    </fieldset>
</div>


<div id="results_by_date">
    <span class="template">
        <div class="offer">
            <a href="user_uri" class="avatar"><img src="user_thumb" alt="username"/></a>
            <a href="user_uri" class="username"></a>
            <p class="msg">
                <span class="text"></span><br/>
                <span class="tags">
                    <span class="tag"><a href="offer"></a>, </span>
                </span>
                <a class="more_info_link" href="more_info_uri">more info &gt;&gt;</a>
            </p>
            <div class="meta">
                <a class="when" href="source_uri">Today, 10:50 am</a>
            </div>
        </div>
    </span>
</div>


<div class="regular" id="main">

<div id="myform">
  <textarea type="text" class="ui-state-disabled" name="message" id="message_to_send"></textarea>
  <button type="button" class="ui-button ui-state-default ui-corner-all" onclick="sendData()">Submit</button>
</div>

<button class="ui-button ui-state-default ui-corner-all open_post" rel="#post_your_own_form">Post Your Own</button>
</div>

<!--[if lt IE 7]>
<script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script>
<![endif]-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"/></script>
<!--OOOOBY.NING.ORG GOOGLE API KEY = ABQIAAAABEpdHyPr3QztCREcH5edthQJninID-M6PHkd65PL9JwO4W5uJxR_4_SFIiW5EiCw9BgVYD7J-NQ32w -->
<!-- google maps API v3 doesn't need an API key! -->
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<!--<script type="text/javascript" src="http://tradeify.org/js/jquery-1.3.2.js"/></script>-->
<script type="text/javascript" src="http://tradeify.org/js/jquery-ui-1.7.2.custom.min.js"/></script>
<script type="text/javascript" src="http://tradeify.org/js/jquery.tools.min.js"/></script>
<script type="text/javascript" src="http://tradeify.org/js/purePacked.js"/></script>
<script type="text/javascript" src="http://tradeify.org/osocial/tradeify_widget.js"/></script>
<script type="text/javascript">
   
var maps_initializing=false;

$(document).ready(function() {
	
	compile_render_functions();
	update_offers();
	update_tags(); //preload some tags
	
  gadgets.window.adjustHeight(2000);

  $("#by_parts input").keyup(update_offer);
	$("#by_parts textarea").keyup(update_offer);
	$("#by_parts input").change(update_offer);

	$(".location input").keydown(function() {
		if (!maps_initializing) {
			maps_initializing = true;
			$("#map_canvas").show();
		}
    });
	
	//hover and click logic for tag links
	$(".fg-button:not(.ui-state-disabled)")
	.mousedown(function(){
			if( $(this).is('.ui-state-active.fg-button-toggleable, .fg-buttonset-multi .ui-state-active') )
				{ $(this).removeClass("ui-state-active"); }
			else { $(this).addClass("ui-state-active"); }	
	})
	.mouseup(function(){
		if(! $(this).is('.fg-button-toggleable, .fg-buttonset-multi .fg-button') ){
			$(this).removeClass("ui-state-active");
		}
	});



	$("#post_your_own_form #until").datepicker(
			{minDate:0,
			 dateFormat: "dd M yy",
			 constrainInput: true,
			 showOn: "focus"
			 });
	
	
	
	var triggers = $(".open_post").overlay({
	
		// some expose tweaks suitable for modal dialogs
		zIndex: 9998,
		closeOnClick	: false,
		expose: {
			zIndex: 9997,
			color: '#333',
			loadSpeed: 200,
			opacity: 0.9,
			closeOnClick: false
		}
	});
	
	$("#post_your_own_form form").submit(function(e) {
	
		// close the overlay
		triggers.overlay().close();
	
		// get user input
		var input = $(".rawMessage #message", this).val();
	
		// do something with the answer
		//triggers.eq(1).html(input);
		$("#message_to_send").val(input);
	
		// do not submit the form
		return e.preventDefault();
	});
    
    // select all desired input fields and attach tooltips to them 
    $("#post_your_own_form :input").tooltip({ 
     
        // place tooltip on the right edge 
        position: "center below", 
     
        // a little tweaking of the position 
        offset: [-2, 10], 
     
        // use the built-in fadeIn/fadeOut effect 
        effect: "fade", 
     
        // custom opacity setting 
        opacity: 0.7, 
     
        // use this single tooltip element 
        tip: '.tooltip' 
     
    });
	
	//$("#post_your_own_form").hide();

	
});
</script>
</div>
</div>
    ]]>
  </Content>
</Module>
